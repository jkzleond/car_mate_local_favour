define(["jquery","backbone","models/UserModel","models/ClockInModel","models/DiscoveryModel","collections/DiscoveryTypeCollection","collections/DiscoveryCollection","views/UserStateView","views/ClockInView","views/DiscoveryTypeView","views/DiscoveryListView","views/DiscoveryDetailPageView","views/discovery/CommentsPageView"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){var p=t.Router.extend({initialize:function(){this.user_state_view=new u({el:e("#user_state"),model:new n({user_id:G.user.user_id})}),this.clock_in_view=new a({el:e("#user_state"),model:new r}),e.cm.bind("system.bonus:huiGold",e.proxy(this.bonusHuiGoldHandler,this)),this.discovery_navbar_view=new f({el:"#discovery_navbar",collection:new s}),this.discovery_list_view_0=new l({el:"#discovery_list_view_0",collection:new o({type:0})}),this.discovery_list_view_6=new l({el:"#discovery_list_view_6",collection:new o({type:6})}),this.discovery_list_view_1=new l({el:"#discovery_list_view_1",collection:new o({type:1})}),this.discovery_list_view_7=new l({el:"#discovery_list_view_7",collection:new o({type:7})}),this.discovery_detail_view=new c({el:"#discovery_detail_page",model:new i}),this.listenTo(this.discovery_detail_view.comment_form_view,"invalid",this._onCommentFormInvalid),this.discovery_comments_page_view=new h},_onCommentFormInvalid:function(t,n){e.cm.toast({msg:n})},bonusHuiGoldHandler:function(e,t){var n=this.user_state_view.model.get("HuiGold")||0;this.user_state_view.model.set("HuiGold",Number(n)+Number(t))},routes:{"":"home",dev:"developing","discoverise(/:type)":"discoverise","discovery/:id":"discoveryDetail","discovery/:id/comments":"discoveryComments"},home:function(){e(":mobile-pagecontainer").pagecontainer("change","#home_page");if(this.user_data_fetched)return;this.user_state_view.model.fetch(),this.clock_in_view.model.fetch(),this.user_data_fetched=!0},developing:function(){e.cm.toast({msg:"此功能正在开发中,敬请期待"})},discoverise:function(t){var t=t||0;e(":mobile-pagecontainer").pagecontainer("change","#discovery_page"),this["discovery_list_view_"+t].collection.fetch();var n=this.discovery_navbar_view.collection.type;e("discovery_list_view_"+n).hide(),this.discovery_navbar_view.collection.setActiveType(t)},discoveryDetail:function(t){e(":mobile-pagecontainer").pagecontainer("change","#discovery_detail_page"),this.discovery_detail_view.model.set("id",t).fetch()},discoveryComments:function(t){console.log(t),e(":mobile-pagecontainer").pagecontainer("change","#discovery_comments_page"),this.discovery_comments_page_view.setDiscoveryId(t)}});return p});