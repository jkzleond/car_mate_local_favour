define(["backbone","models/discovery/CommentModel","jqm"],function(e,t){var n=e.View.extend({model:new t,_strict_content_len:100,initialize:function(){this._strict_content_len=Number(this.$el.find(".content").attr("maxlength")),this.listenTo(this.model,"invalid",this._onModelInvalid),this.listenTo(this.model,"change:id",this._onCommentGen)},events:{"input .content":"_onContentInput","click .submit":"_onSubmit"},_onContentInput:function(e){var t=$(e.target),n=t.val();n.length<5?this.$el.find(".submit").prop("disabled",!0):this.$el.find(".submit").prop("disabled",!1),t.val(n),this.$el.find(".char-num").text(this._strict_content_len-n.length)},_onSubmit:function(){this._collectionFormData(),this.model.isValid()&&this.model.save(),this.close()},_onCommentGen:function(e,t,n){this.trigger("commentgen",this,t)},_onModelInvalid:function(e,t){this.trigger("invalid",this,t)},open:function(){this.$el.popup("open")},close:function(){this.$el.popup("close")},_collectionFormData:function(){var e=this;this.$el.find("[name]").each(function(t,n){var r=$(n).attr("name"),i=$(n).val();e.model.set(r,i,{silent:!0})}),this.model.set("user_id",G.user.user_id)}});return n});