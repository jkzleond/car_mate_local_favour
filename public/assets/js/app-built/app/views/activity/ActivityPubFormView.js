define(["jquery","backbone","models/activity/ActivityPubFormModel","jqm","datetimepicker"],function(e,t,n){var r=t.View.extend({model:new n,initialize:function(){this.$el.find('[name="start_date"]').datetimepicker({lang:"ch",format:"Y-m-d",formatDate:"Y/m/d",timepicker:!1}),this.$el.find('[name="end_date"]').datetimepicker({lang:"ch",format:"Y-m-d",formatDate:"Y/m/d",timepicker:!1}),this.listenTo(this.model,"change:activity_id",this._onNewActivityPubed),this.listenTo(this.model,"invalid",this._onPubModelInvalid)},events:{"click .submit-btn":"_onSubmitBtnClick"},_onSubmitBtnClick:function(e){this._collectionData(),this.model.isValid()&&this.model.save()},_onNewActivityPubed:function(e,t){this.trigger("activitygen",this,this.model.get("activity_id"))},_onPubModelInvalid:function(e,t){this.trigger("invalid:pub",this,t)},_collectionData:function(){var t=this;this.model.clear({silent:!0}),this.$el.find("[name]").each(function(n,r){if(e(r).is(":radio")&&!e(r).is(":checked"))return;var i=e(r).attr("name"),s=e(r).val();t.model.set(i,s,{silent:!0})}),t.model.set("pub_user",G.user.user_id,{silent:!0})}});return r});