define(["jquery","underscore","backbone","models/insurance/InsuranceInfoModel","collections/insurance/InsuranceCompanyCollection","text!templates/insurance/first_price_page.html","text!templates/insurance/discount_detail.html"],function(e,t,n,r,i,s,o){e(s).appendTo("body");var u=n.View.extend({el:"#insurance_first_price_page",initialize:function(e){this.total_standard=0,this.discount_detail_tpl=t.template(o),this.insurance_info=new r,this.company=new i,this.listenTo(this.insurance_info,"change:result",this._resultProcess),this.listenTo(this.company,"reset",this._discountProcess)},events:{"click .apply-actual-btn":"_onApplyActualBtnClick"},_onApplyActualBtnClick:function(e){this.trigger("uri",this,"insurance/apply_actual/"+this.insurance_info.get("id"))},_resultProcess:function(e,t,n){if(this.company.models.length==0)return;var r=this.company.models[0].attributes,i=this.insurance_info.result.attributes;this.$el.find(".discount-detail").empty().append(this.discount_detail_tpl({company:r,result:i})),this.$el.find(".apply-actual-btn").show()},_discountProcess:function(e,t){if(this.total_standard==0)return;var n=this.company.models[0].attributes,r=this.insurance_info.result.attributes;this.$el.find(".discount-detail").empty().append(this.discount_detail_tpl({company:n,result:r})),this.$el.find(".apply-actual-btn").show()},loadInfo:function(e){this.$el.find(".apply-actual-btn").hide(),this.$el.find(".discount-detail").empty(),this.insurance_info.set("id",e,{silent:!0}),this.insurance_info.fetch(),this.company.fetch({reset:!0})}});return u});