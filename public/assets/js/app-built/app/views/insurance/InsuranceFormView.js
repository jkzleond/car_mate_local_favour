define(["jquery","backbone","views/ProvinceSelectView","views/CitySelectView"],function(e,t,n,r){var i=t.View.extend({initialize:function(t){this.province_collection=t.province_collection,this.city_collection=t.city_collection,this.province_select_view=new n({collection:this.province_collection,el:"#insurance_province_sel",value:t.province_vlaue}),this.city_select_view=new r({collection:this.city_collection,el:"#insurance_city_sel",value:t.city_value}),this.listenTo(this.province_select_view,"change",this.onProvinceSelectChange),this.$el.find("[name=insurance_set_id]").val("3").change();var i=this;this.province_select_view.$el.change(function(){i.model.set({province_id:e(this).val()})}),this.city_select_view.$el.change(function(){i.model.set({city_id:e(this).val()})})},setProvinceValue:function(e){this.province_select_view.setValue(e)},getModel:function(){return this.model.set({province_id:this.province_select_view.$el.val(),city_id:this.city_select_view.$el.val(),car_price:this.$el.find("[name=car_price]").val(),phone:this.$el.find('[name="phone"]').val(),service_years:this.$el.find('[name="service_price"]').val()}),this.model},_collectFormData:function(){var t={},n=[],r=/^need_(.*)/;this.$el.find("[name]").each(function(i,s){var o=e(s).attr("name");if(n.indexOf(o)!=-1)return;if(e(s).attr("type")=="checkbox"&&!e(s).prop("checked")){var u=o.match(r),a=u?u[1]:null;a&&(a in t?delete t[a]:n.push(a));return}var f=e(s).val();if(o=="car_price"||o=="driver"||o=="passenger")f*=1e4;t[o]=f}),this.model.clear({silent:!0}).set(t,{silent:!0})},onProvinceSelectChange:function(e,t,n){this.city_select_view.collection.setProvinceId(n)},events:{"change [car_price]":"onCarPriceChange","change [name=phone]":"onPhoneChange","change [name=service_year]":"onServiceYearChange","change [name=insurance_set_id]":"onInsuranceSetChange","change [name=damage]":"onDamageChange","change [name=self_ignition]":"onSelfIgnitionChange","click #insurance_get_price_btn":"onGetPriceClick"},onCarPriceChange:function(){var e=this.$el.find('[name="car_price"]').val();this.model.set({car_price:e})},onPhoneChange:function(){var e=this.$el.find('[name="phone"]').val();this.model.set({phone:e})},onServiceYearChange:function(){var e=this.$el.find('[name="service_years"]').val();this.model.set({service_years:e})},onInsuranceSetChange:function(t){var n=e(t.target).val();switch(n){case"1":e('input[type="checkbox"]').prop("checked",!0).checkboxradio("refresh");break;case"2":e('input[type="checkbox"]').prop("checked",!1),e('input[type="checkbox"][data-set*=effective]').prop("checked",!0),e('input[type="checkbox"]').checkboxradio("refresh");break;case"3":e('input[type="checkbox"]').prop("checked",!1),e('input[type="checkbox"][data-set*=simple]').prop("checked",!0),e('input[type="checkbox"]').checkboxradio("refresh");break;case"4":e('input[type="checkbox"]').prop("checked",!1),e('input[type="checkbox"][data-set*=skilled]').prop("checked",!0),e('input[type="checkbox"]').checkboxradio("refresh");break;default:}},onDamageChange:function(t){var n=e(t.target).prop("checked");n||this.$el.find("[name=self_ignition]").prop("checked",!1).checkboxradio("refresh")},onSelfIgnitionChange:function(t){var n=e(t.target).prop("checked");n&&this.$el.find("[name=damage]").prop("checked",!0).checkboxradio("refresh")},onGetPriceClick:function(){this._collectFormData(),this.trigger("submit",this)}});return i});