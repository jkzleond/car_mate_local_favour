/**
 * jqPlot
 * Pure JavaScript plotting plugin using jQuery
 *
 * Version: 1.0.8
 * Revision: 1250
 *
 * Copyright (c) 2009-2013 Chris Leonello
 * jqPlot is currently available for use in all personal or commercial projects 
 * under both the MIT (http://www.opensource.org/licenses/mit-license.php) and GPL 
 * version 2.0 (http://www.gnu.org/licenses/gpl-2.0.html) licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly. 
 *
 * Although not required, the author would appreciate an email letting him 
 * know of any substantial use of jqPlot.  You can reach the author at: 
 * chris at jqplot dot com or see http://www.jqplot.com/info.php .
 *
 * If you are feeling kind and generous, consider supporting the project by
 * making a donation at: http://www.jqplot.com/donate.php .
 *
 * sprintf functions contained in jqplot.sprintf.js by Ash Searle:
 *
 *     version 2007.04.27
 *     author Ash Searle
 *     http://hexmen.com/blog/2007/03/printf-sprintf/
 *     http://hexmen.com/js/sprintf.js
 *     The author (Ash Searle) has placed this code in the public domain:
 *     "This code is unrestricted: you are free to use it however you like."
 * 
 */

(function(e){e.jqplot.MekkoAxisRenderer=function(){},e.jqplot.MekkoAxisRenderer.prototype.init=function(t){this.tickMode,this.barLabelRenderer=e.jqplot.AxisLabelRenderer,this.barLabels=this.barLabels||[],this.barLabelOptions={},this.tickOptions=e.extend(!0,{showGridline:!1},this.tickOptions),this._barLabels=[],e.extend(!0,this,t),this.name=="yaxis"&&(this.tickOptions.formatString=this.tickOptions.formatString||"%d%");var n=this._dataBounds;n.min=0;if(this.name=="yaxis"||this.name=="y2axis")n.max=100,this.tickMode="even";else if(this.name=="xaxis"){this.tickMode=this.tickMode==null?"bar":this.tickMode;for(var r=0;r<this._series.length;r++)n.max+=this._series[r]._sumy}else if(this.name=="x2axis"){this.tickMode=this.tickMode==null?"even":this.tickMode;for(var r=0;r<this._series.length;r++)n.max+=this._series[r]._sumy}},e.jqplot.MekkoAxisRenderer.prototype.draw=function(t,n){if(this.show){this.renderer.createTicks.call(this);var r=0,i,s=document.createElement("div");this._elem=e(s),this._elem.addClass("jqplot-axis jqplot-"+this.name),this._elem.css("position","absolute"),s=null,this.name=="xaxis"||this.name=="x2axis"?this._elem.width(this._plotDimensions.width):this._elem.height(this._plotDimensions.height),this.labelOptions.axis=this.name,this._label=new this.labelRenderer(this.labelOptions),this._label.show&&this._elem.append(this._label.draw(t));var o,u,s;if(this.showTicks){o=this._ticks;for(var a=0;a<o.length;a++)u=o[a],u.showLabel&&(!u.isMinorTick||this.showMinorTicks)&&this._elem.append(u.draw(t))}for(a=0;a<this.barLabels.length;a++){this.barLabelOptions.axis=this.name,this.barLabelOptions.label=this.barLabels[a],this._barLabels.push(new this.barLabelRenderer(this.barLabelOptions)),this.tickMode!="bar"&&(this._barLabels[a].show=!1);if(this._barLabels[a].show){var s=this._barLabels[a].draw(t,n);s.removeClass("jqplot-"+this.name+"-label"),s.addClass("jqplot-"+this.name+"-tick"),s.addClass("jqplot-mekko-barLabel"),s.appendTo(this._elem),s=null}}}return this._elem},e.jqplot.MekkoAxisRenderer.prototype.reset=function(){this.min=this._min,this.max=this._max,this.tickInterval=this._tickInterval,this.numberTicks=this._numberTicks},e.jqplot.MekkoAxisRenderer.prototype.set=function(){var t=0,n,r=0,i=0,s=this._label==null?!1:this._label.show;if(this.show&&this.showTicks){var o=this._ticks;for(var u=0;u<o.length;u++){var a=o[u];a.showLabel&&(!a.isMinorTick||this.showMinorTicks)&&(this.name=="xaxis"||this.name=="x2axis"?n=a._elem.outerHeight(!0):n=a._elem.outerWidth(!0),n>t&&(t=n))}s&&(r=this._label._elem.outerWidth(!0),i=this._label._elem.outerHeight(!0)),this.name=="xaxis"?(t+=i,this._elem.css({height:t+"px",left:"0px",bottom:"0px"})):this.name=="x2axis"?(t+=i,this._elem.css({height:t+"px",left:"0px",top:"0px"})):this.name=="yaxis"?(t+=r,this._elem.css({width:t+"px",left:"0px",top:"0px"}),s&&this._label.constructor==e.jqplot.AxisLabelRenderer&&this._label._elem.css("width",r+"px")):(t+=r,this._elem.css({width:t+"px",right:"0px",top:"0px"}),s&&this._label.constructor==e.jqplot.AxisLabelRenderer&&this._label._elem.css("width",r+"px"))}},e.jqplot.MekkoAxisRenderer.prototype.createTicks=function(){var e=this._ticks,t=this.ticks,n=this.name,r=this._dataBounds,i,s,o,u,a,f,l,c,h,p;if(t.length){for(h=0;h<t.length;h++){var d=t[h],l=new this.tickRenderer(this.tickOptions);d.constructor==Array?(l.value=d[0],l.label=d[1],this.showTicks?this.showTickMarks||(l.showMark=!1):(l.showLabel=!1,l.showMark=!1),l.setTick(d[0],this.name),this._ticks.push(l)):(l.value=d,this.showTicks?this.showTickMarks||(l.showMark=!1):(l.showLabel=!1,l.showMark=!1),l.setTick(d,this.name),this._ticks.push(l))}this.numberTicks=t.length,this.min=this._ticks[0].value,this.max=this._ticks[this.numberTicks-1].value,this.tickInterval=(this.max-this.min)/(this.numberTicks-1)}else{n=="xaxis"||n=="x2axis"?i=this._plotDimensions.width:i=this._plotDimensions.height,this.min!=null&&this.max!=null&&this.numberTicks!=null&&(this.tickInterval=null),o=this.min!=null?this.min:r.min,u=this.max!=null?this.max:r.max;if(o==u){var v=.05;o>0&&(v=Math.max(Math.log(o)/Math.LN10,.05)),o-=v,u+=v}var m=u-o,g,y,b,w,E,S=[3,5,6,11,21];if(this.name=="yaxis"||this.name=="y2axis"){this.min=0,this.max=100;if(!this.numberTicks)if(this.tickInterval)this.numberTicks=3+Math.ceil(m/this.tickInterval);else{b=2+Math.ceil((i-(this.tickSpacing-1))/this.tickSpacing);for(h=0;h<S.length;h++){E=b/S[h];if(E==1){this.numberTicks=S[h];break}if(E>1){w=E;continue}if(E<1){if(Math.abs(w-1)<Math.abs(E-1)){this.numberTicks=S[h-1];break}this.numberTicks=S[h];break}h==S.length-1&&(this.numberTicks=S[h])}this.tickInterval=m/(this.numberTicks-1)}else this.tickInterval=m/(this.numberTicks-1);for(var h=0;h<this.numberTicks;h++)c=this.min+h*this.tickInterval,l=new this.tickRenderer(this.tickOptions),this.showTicks?this.showTickMarks||(l.showMark=!1):(l.showLabel=!1,l.showMark=!1),l.setTick(c,this.name),this._ticks.push(l)}else if(this.tickMode=="bar"){this.min=0,this.numberTicks=this._series.length+1,l=new this.tickRenderer(this.tickOptions),this.showTicks?this.showTickMarks||(l.showMark=!1):(l.showLabel=!1,l.showMark=!1),l.setTick(0,this.name),this._ticks.push(l),b=0;for(h=1;h<this.numberTicks;h++)b+=this._series[h-1]._sumy,l=new this.tickRenderer(this.tickOptions),this.showTicks?this.showTickMarks||(l.showMark=!1):(l.showLabel=!1,l.showMark=!1),l.setTick(b,this.name),this._ticks.push(l);this.max=this.max||b,this.max>b&&(l=new this.tickRenderer(this.tickOptions),this.showTicks?this.showTickMarks||(l.showMark=!1):(l.showLabel=!1,l.showMark=!1),l.setTick(this.max,this.name),this._ticks.push(l))}else if(this.tickMode=="even"){this.min=0,this.max=this.max||r.max;var x=2+Math.ceil((i-(this.tickSpacing-1))/this.tickSpacing);m=this.max-this.min,this.numberTicks=x,this.tickInterval=m/(this.numberTicks-1);for(h=0;h<this.numberTicks;h++)c=this.min+h*this.tickInterval,l=new this.tickRenderer(this.tickOptions),this.showTicks?this.showTickMarks||(l.showMark=!1):(l.showLabel=!1,l.showMark=!1),l.setTick(c,this.name),this._ticks.push(l)}}},e.jqplot.MekkoAxisRenderer.prototype.pack=function(t,n){var r=this._ticks,i=this.max,s=this.min,o=n.max,u=n.min,a=this._label==null?!1:this._label.show;for(var f in t)this._elem.css(f,t[f]);this._offsets=n;var l=o-u,c=i-s;this.p2u=function(e){return(e-u)*c/l+s},this.u2p=function(e){return(e-s)*l/c+u},this.name=="xaxis"||this.name=="x2axis"?(this.series_u2p=function(e){return(e-s)*l/c},this.series_p2u=function(e){return e*c/l+s}):(this.series_u2p=function(e){return(e-i)*l/c},this.series_p2u=function(e){return e*c/l+i});if(this.show)if(this.name=="xaxis"||this.name=="x2axis"){for(var h=0;h<r.length;h++){var p=r[h];if(p.show&&p.showLabel){var d;if(p.constructor==e.jqplot.CanvasAxisTickRenderer&&p.angle){var v=this.name=="xaxis"?1:-1;switch(p.labelPosition){case"auto":v*p.angle<0?d=-p.getWidth()+p._textRenderer.height*Math.sin(-p._textRenderer.angle)/2:d=-p._textRenderer.height*Math.sin(p._textRenderer.angle)/2;break;case"end":d=-p.getWidth()+p._textRenderer.height*Math.sin(-p._textRenderer.angle)/2;break;case"start":d=-p._textRenderer.height*Math.sin(p._textRenderer.angle)/2;break;case"middle":d=-p.getWidth()/2+p._textRenderer.height*Math.sin(-p._textRenderer.angle)/2;break;default:d=-p.getWidth()/2+p._textRenderer.height*Math.sin(-p._textRenderer.angle)/2}}else d=-p.getWidth()/2;var m=this.u2p(p.value)+d+"px";p._elem.css("left",m),p.pack()}}var g;a&&(g=this._label._elem.outerWidth(!0),this._label._elem.css("left",u+l/2-g/2+"px"),this.name=="xaxis"?this._label._elem.css("bottom","0px"):this._label._elem.css("top","0px"),this._label.pack());var y,b,w;for(var h=0;h<this.barLabels.length;h++)y=this._barLabels[h],y.show&&(g=y.getWidth(),b=this._ticks[h].getLeft()+this._ticks[h].getWidth(),w=this._ticks[h+1].getLeft(),y._elem.css("left",(w+b-g)/2+"px"),y._elem.css("top",this._ticks[h]._elem.css("top")),y.pack())}else{for(var h=0;h<r.length;h++){var p=r[h];if(p.show&&p.showLabel){var d;if(p.constructor==e.jqplot.CanvasAxisTickRenderer&&p.angle){var v=this.name=="yaxis"?1:-1;switch(p.labelPosition){case"auto":case"end":v*p.angle<0?d=-p._textRenderer.height*Math.cos(-p._textRenderer.angle)/2:d=-p.getHeight()+p._textRenderer.height*Math.cos(p._textRenderer.angle)/2;break;case"start":p.angle>0?d=-p._textRenderer.height*Math.cos(-p._textRenderer.angle)/2:d=-p.getHeight()+p._textRenderer.height*Math.cos(p._textRenderer.angle)/2;break;case"middle":d=-p.getHeight()/2;break;default:d=-p.getHeight()/2}}else d=-p.getHeight()/2;var m=this.u2p(p.value)+d+"px";p._elem.css("top",m),p.pack()}}if(a){var E=this._label._elem.outerHeight(!0);this._label._elem.css("top",o-l/2-E/2+"px"),this.name=="yaxis"?this._label._elem.css("left","0px"):this._label._elem.css("right","0px"),this._label.pack()}}}})(jQuery);