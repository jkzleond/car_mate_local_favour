/**
 * jqPlot
 * Pure JavaScript plotting plugin using jQuery
 *
 * Version: 1.0.8
 * Revision: 1250
 *
 * Copyright (c) 2009-2013 Chris Leonello
 * jqPlot is currently available for use in all personal or commercial projects 
 * under both the MIT (http://www.opensource.org/licenses/mit-license.php) and GPL 
 * version 2.0 (http://www.gnu.org/licenses/gpl-2.0.html) licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly. 
 *
 * Although not required, the author would appreciate an email letting him 
 * know of any substantial use of jqPlot.  You can reach the author at: 
 * chris at jqplot dot com or see http://www.jqplot.com/info.php .
 *
 * If you are feeling kind and generous, consider supporting the project by
 * making a donation at: http://www.jqplot.com/donate.php .
 *
 * sprintf functions contained in jqplot.sprintf.js by Ash Searle:
 *
 *     version 2007.04.27
 *     author Ash Searle
 *     http://hexmen.com/blog/2007/03/printf-sprintf/
 *     http://hexmen.com/js/sprintf.js
 *     The author (Ash Searle) has placed this code in the public domain:
 *     "This code is unrestricted: you are free to use it however you like."
 * 
 */

(function(e){e.jqplot.CategoryAxisRenderer=function(t){e.jqplot.LinearAxisRenderer.call(this),this.sortMergedLabels=!1},e.jqplot.CategoryAxisRenderer.prototype=new e.jqplot.LinearAxisRenderer,e.jqplot.CategoryAxisRenderer.prototype.constructor=e.jqplot.CategoryAxisRenderer,e.jqplot.CategoryAxisRenderer.prototype.init=function(t){this.groups=1,this.groupLabels=[],this._groupLabels=[],this._grouped=!1,this._barsPerGroup=null,this.reverse=!1,e.extend(!0,this,{tickOptions:{formatString:"%d"}},t);var n=this._dataBounds;for(var r=0;r<this._series.length;r++){var i=this._series[r];i.groups&&(this.groups=i.groups);var s=i.data;for(var o=0;o<s.length;o++)if(this.name=="xaxis"||this.name=="x2axis"){if(s[o][0]<n.min||n.min==null)n.min=s[o][0];if(s[o][0]>n.max||n.max==null)n.max=s[o][0]}else{if(s[o][1]<n.min||n.min==null)n.min=s[o][1];if(s[o][1]>n.max||n.max==null)n.max=s[o][1]}}this.groupLabels.length&&(this.groups=this.groupLabels.length)},e.jqplot.CategoryAxisRenderer.prototype.createTicks=function(){var t=this._ticks,n=this.ticks,r=this.name,i=this._dataBounds,s,o,u,a,f,l,c,h;if(n.length){if(this.groups>1&&!this._grouped){var p=n.length,d=parseInt(p/this.groups,10),v=0;for(var h=d;h<p;h+=d)n.splice(h+v,0," "),v++;this._grouped=!0}this.min=.5,this.max=n.length+.5;var m=this.max-this.min;this.numberTicks=2*n.length+1;for(h=0;h<n.length;h++){c=this.min+2*h*m/(this.numberTicks-1);var g=new this.tickRenderer(this.tickOptions);g.showLabel=!1,g.setTick(c,this.name),this._ticks.push(g);var g=new this.tickRenderer(this.tickOptions);g.label=n[h],g.showMark=!1,g.showGridline=!1,g.setTick(c+.5,this.name),this._ticks.push(g)}var g=new this.tickRenderer(this.tickOptions);g.showLabel=!1,g.setTick(c+1,this.name),this._ticks.push(g)}else{r=="xaxis"||r=="x2axis"?s=this._plotDimensions.width:s=this._plotDimensions.height,this.min!=null&&this.max!=null&&this.numberTicks!=null&&(this.tickInterval=null),this.min!=null&&this.max!=null&&this.tickInterval!=null&&parseInt((this.max-this.min)/this.tickInterval,10)!=(this.max-this.min)/this.tickInterval&&(this.tickInterval=null);var y=[],b=0,u=.5,a,w,E=!1;for(var h=0;h<this._series.length;h++){var S=this._series[h];for(var x=0;x<S.data.length;x++)this.name=="xaxis"||this.name=="x2axis"?w=S.data[x][0]:w=S.data[x][1],e.inArray(w,y)==-1&&(E=!0,b+=1,y.push(w))}E&&this.sortMergedLabels&&(typeof y[0]=="string"?y.sort():y.sort(function(e,t){return e-t})),this.ticks=y;for(var h=0;h<this._series.length;h++){var S=this._series[h];for(var x=0;x<S.data.length;x++){this.name=="xaxis"||this.name=="x2axis"?w=S.data[x][0]:w=S.data[x][1];var T=e.inArray(w,y)+1;this.name=="xaxis"||this.name=="x2axis"?S.data[x][0]=T:S.data[x][1]=T}}if(this.groups>1&&!this._grouped){var p=y.length,d=parseInt(p/this.groups,10),v=0;for(var h=d;h<p;h+=d+1)y[h]=" ";this._grouped=!0}a=b+.5,this.numberTicks==null&&(this.numberTicks=2*b+1);var m=a-u;this.min=u,this.max=a;var N=0,C=parseInt(3+s/10,10),d=parseInt(b/C,10);this.tickInterval==null&&(this.tickInterval=m/(this.numberTicks-1));for(var h=0;h<this.numberTicks;h++){c=this.min+h*this.tickInterval;var g=new this.tickRenderer(this.tickOptions);h/2==parseInt(h/2,10)?(g.showLabel=!1,g.showMark=!0):(d>0&&N<d?(g.showLabel=!1,N+=1):(g.showLabel=!0,N=0),g.label=g.formatter(g.formatString,y[(h-1)/2]),g.showMark=!1,g.showGridline=!1),g.setTick(c,this.name),this._ticks.push(g)}}},e.jqplot.CategoryAxisRenderer.prototype.draw=function(t,n){if(this.show){this.renderer.createTicks.call(this);var r=0,i;this._elem&&this._elem.emptyForce(),this._elem=this._elem||e('<div class="jqplot-axis jqplot-'+this.name+'" style="position:absolute;"></div>'),this.name=="xaxis"||this.name=="x2axis"?this._elem.width(this._plotDimensions.width):this._elem.height(this._plotDimensions.height),this.labelOptions.axis=this.name,this._label=new this.labelRenderer(this.labelOptions);if(this._label.show){var s=this._label.draw(t,n);s.appendTo(this._elem)}var o=this._ticks;for(var u=0;u<o.length;u++){var a=o[u];if(a.showLabel&&(!a.isMinorTick||this.showMinorTicks)){var s=a.draw(t,n);s.appendTo(this._elem)}}this._groupLabels=[];for(var u=0;u<this.groupLabels.length;u++){var s=e('<div style="position:absolute;" class="jqplot-'+this.name+'-groupLabel"></div>');s.html(this.groupLabels[u]),this._groupLabels.push(s),s.appendTo(this._elem)}}return this._elem},e.jqplot.CategoryAxisRenderer.prototype.set=function(){var t=0,n,r=0,i=0,s=this._label==null?!1:this._label.show;if(this.show){var o=this._ticks;for(var u=0;u<o.length;u++){var a=o[u];a.showLabel&&(!a.isMinorTick||this.showMinorTicks)&&(this.name=="xaxis"||this.name=="x2axis"?n=a._elem.outerHeight(!0):n=a._elem.outerWidth(!0),n>t&&(t=n))}var f=0;for(var u=0;u<this._groupLabels.length;u++){var l=this._groupLabels[u];this.name=="xaxis"||this.name=="x2axis"?n=l.outerHeight(!0):n=l.outerWidth(!0),n>f&&(f=n)}s&&(r=this._label._elem.outerWidth(!0),i=this._label._elem.outerHeight(!0)),this.name=="xaxis"?(t+=f+i,this._elem.css({height:t+"px",left:"0px",bottom:"0px"})):this.name=="x2axis"?(t+=f+i,this._elem.css({height:t+"px",left:"0px",top:"0px"})):this.name=="yaxis"?(t+=f+r,this._elem.css({width:t+"px",left:"0px",top:"0px"}),s&&this._label.constructor==e.jqplot.AxisLabelRenderer&&this._label._elem.css("width",r+"px")):(t+=f+r,this._elem.css({width:t+"px",right:"0px",top:"0px"}),s&&this._label.constructor==e.jqplot.AxisLabelRenderer&&this._label._elem.css("width",r+"px"))}},e.jqplot.CategoryAxisRenderer.prototype.pack=function(t,n){var r=this._ticks,i=this.max,s=this.min,o=n.max,u=n.min,a=this._label==null?!1:this._label.show,f;for(var l in t)this._elem.css(l,t[l]);this._offsets=n;var c=o-u,h=i-s;this.reverse?(this.u2p=function(e){return u+(i-e)*c/h},this.p2u=function(e){return s+(e-u)*h/c},this.name=="xaxis"||this.name=="x2axis"?(this.series_u2p=function(e){return(i-e)*c/h},this.series_p2u=function(e){return e*h/c+i}):(this.series_u2p=function(e){return(s-e)*c/h},this.series_p2u=function(e){return e*h/c+s})):(this.u2p=function(e){return(e-s)*c/h+u},this.p2u=function(e){return(e-u)*h/c+s},this.name=="xaxis"||this.name=="x2axis"?(this.series_u2p=function(e){return(e-s)*c/h},this.series_p2u=function(e){return e*h/c+s}):(this.series_u2p=function(e){return(e-i)*c/h},this.series_p2u=function(e){return e*h/c+i}));if(this.show)if(this.name=="xaxis"||this.name=="x2axis"){for(f=0;f<r.length;f++){var p=r[f];if(p.show&&p.showLabel){var d;if(p.constructor==e.jqplot.CanvasAxisTickRenderer&&p.angle){var v=this.name=="xaxis"?1:-1;switch(p.labelPosition){case"auto":v*p.angle<0?d=-p.getWidth()+p._textRenderer.height*Math.sin(-p._textRenderer.angle)/2:d=-p._textRenderer.height*Math.sin(p._textRenderer.angle)/2;break;case"end":d=-p.getWidth()+p._textRenderer.height*Math.sin(-p._textRenderer.angle)/2;break;case"start":d=-p._textRenderer.height*Math.sin(p._textRenderer.angle)/2;break;case"middle":d=-p.getWidth()/2+p._textRenderer.height*Math.sin(-p._textRenderer.angle)/2;break;default:d=-p.getWidth()/2+p._textRenderer.height*Math.sin(-p._textRenderer.angle)/2}}else d=-p.getWidth()/2;var m=this.u2p(p.value)+d+"px";p._elem.css("left",m),p.pack()}}var g=["bottom",0];if(a){var y=this._label._elem.outerWidth(!0);this._label._elem.css("left",u+c/2-y/2+"px"),this.name=="xaxis"?(this._label._elem.css("bottom","0px"),g=["bottom",this._label._elem.outerHeight(!0)]):(this._label._elem.css("top","0px"),g=["top",this._label._elem.outerHeight(!0)]),this._label.pack()}var b=parseInt(this._ticks.length/this.groups,10)+1;for(f=0;f<this._groupLabels.length;f++){var w=0,E=0;for(var S=f*b;S<(f+1)*b;S++){if(S>=this._ticks.length-1)continue;if(this._ticks[S]._elem&&this._ticks[S].label!=" "){var p=this._ticks[S]._elem,l=p.position();w+=l.left+p.outerWidth(!0)/2,E++}}w/=E,this._groupLabels[f].css({left:w-this._groupLabels[f].outerWidth(!0)/2}),this._groupLabels[f].css(g[0],g[1])}}else{for(f=0;f<r.length;f++){var p=r[f];if(p.show&&p.showLabel){var d;if(p.constructor==e.jqplot.CanvasAxisTickRenderer&&p.angle){var v=this.name=="yaxis"?1:-1;switch(p.labelPosition){case"auto":case"end":v*p.angle<0?d=-p._textRenderer.height*Math.cos(-p._textRenderer.angle)/2:d=-p.getHeight()+p._textRenderer.height*Math.cos(p._textRenderer.angle)/2;break;case"start":p.angle>0?d=-p._textRenderer.height*Math.cos(-p._textRenderer.angle)/2:d=-p.getHeight()+p._textRenderer.height*Math.cos(p._textRenderer.angle)/2;break;case"middle":d=-p.getHeight()/2;break;default:d=-p.getHeight()/2}}else d=-p.getHeight()/2;var m=this.u2p(p.value)+d+"px";p._elem.css("top",m),p.pack()}}var g=["left",0];if(a){var x=this._label._elem.outerHeight(!0);this._label._elem.css("top",o-c/2-x/2+"px"),this.name=="yaxis"?(this._label._elem.css("left","0px"),g=["left",this._label._elem.outerWidth(!0)]):(this._label._elem.css("right","0px"),g=["right",this._label._elem.outerWidth(!0)]),this._label.pack()}var b=parseInt(this._ticks.length/this.groups,10)+1;for(f=0;f<this._groupLabels.length;f++){var w=0,E=0;for(var S=f*b;S<(f+1)*b;S++){if(S>=this._ticks.length-1)continue;if(this._ticks[S]._elem&&this._ticks[S].label!=" "){var p=this._ticks[S]._elem,l=p.position();w+=l.top+p.outerHeight()/2,E++}}w/=E,this._groupLabels[f].css({top:w-this._groupLabels[f].outerHeight()/2}),this._groupLabels[f].css(g[0],g[1])}}}})(jQuery);