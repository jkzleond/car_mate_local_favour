/**
 * jqPlot
 * Pure JavaScript plotting plugin using jQuery
 *
 * Version: 1.0.8
 * Revision: 1250
 *
 * Copyright (c) 2009-2013 Chris Leonello
 * jqPlot is currently available for use in all personal or commercial projects 
 * under both the MIT (http://www.opensource.org/licenses/mit-license.php) and GPL 
 * version 2.0 (http://www.gnu.org/licenses/gpl-2.0.html) licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly. 
 *
 * Although not required, the author would appreciate an email letting him 
 * know of any substantial use of jqPlot.  You can reach the author at: 
 * chris at jqplot dot com or see http://www.jqplot.com/info.php .
 *
 * If you are feeling kind and generous, consider supporting the project by
 * making a donation at: http://www.jqplot.com/donate.php .
 *
 * sprintf functions contained in jqplot.sprintf.js by Ash Searle:
 *
 *     version 2007.04.27
 *     author Ash Searle
 *     http://hexmen.com/blog/2007/03/printf-sprintf/
 *     http://hexmen.com/js/sprintf.js
 *     The author (Ash Searle) has placed this code in the public domain:
 *     "This code is unrestricted: you are free to use it however you like."
 * 
 */

(function(e){function h(e,t,n){var r=Number.MAX_VALUE,i,s,o;for(var u=0,a=l.length;u<a;u++)i=Math.abs(n-l[u]),i<r&&(r=i,s=l[u],o=f[u]);return[s,o]}e.jqplot.DateAxisRenderer=function(){e.jqplot.LinearAxisRenderer.call(this),this.date=new e.jsDate};var t=1e3,n=60*t,r=60*n,i=24*r,s=7*i,o=30.4368499*i,u=365.242199*i,a=[31,28,31,30,31,30,31,30,31,30,31,30],f=["%M:%S.%#N","%M:%S.%#N","%M:%S.%#N","%M:%S","%M:%S","%M:%S","%M:%S","%H:%M:%S","%H:%M:%S","%H:%M","%H:%M","%H:%M","%H:%M","%H:%M","%H:%M","%a %H:%M","%a %H:%M","%b %e %H:%M","%b %e %H:%M","%b %e %H:%M","%b %e %H:%M","%v","%v","%v","%v","%v","%v","%v"],l=[.1*t,.2*t,.5*t,t,2*t,5*t,10*t,15*t,30*t,n,2*n,5*n,10*n,15*n,30*n,r,2*r,4*r,6*r,8*r,12*r,i,2*i,3*i,4*i,5*i,s,2*s],c=[];e.jqplot.DateAxisRenderer.prototype=new e.jqplot.LinearAxisRenderer,e.jqplot.DateAxisRenderer.prototype.constructor=e.jqplot.DateAxisRenderer,e.jqplot.DateTickFormatter=function(t,n){return t||(t="%Y/%m/%d"),e.jsDate.strftime(n,t)},e.jqplot.DateAxisRenderer.prototype.init=function(t){this.tickOptions.formatter=e.jqplot.DateTickFormatter,this.tickInset=0,this.drawBaseline=!0,this.baselineWidth=null,this.baselineColor=null,this.daTickInterval=null,this._daTickInterval=null,e.extend(!0,this,t);var n=this._dataBounds,r,i,s,o,u,a,f;for(var l=0;l<this._series.length;l++){r={intervals:[],frequencies:{},sortedIntervals:[],min:null,max:null,mean:null},i=0,s=this._series[l],o=s.data,u=s._plotData,a=s._stackData,f=0;for(var c=0;c<o.length;c++){if(this.name=="xaxis"||this.name=="x2axis"){o[c][0]=(new e.jsDate(o[c][0])).getTime(),u[c][0]=(new e.jsDate(o[c][0])).getTime(),a[c][0]=(new e.jsDate(o[c][0])).getTime();if(o[c][0]!=null&&o[c][0]<n.min||n.min==null)n.min=o[c][0];if(o[c][0]!=null&&o[c][0]>n.max||n.max==null)n.max=o[c][0];c>0&&(f=Math.abs(o[c][0]-o[c-1][0]),r.intervals.push(f),r.frequencies.hasOwnProperty(f)?r.frequencies[f]+=1:r.frequencies[f]=1),i+=f}else{o[c][1]=(new e.jsDate(o[c][1])).getTime(),u[c][1]=(new e.jsDate(o[c][1])).getTime(),a[c][1]=(new e.jsDate(o[c][1])).getTime();if(o[c][1]!=null&&o[c][1]<n.min||n.min==null)n.min=o[c][1];if(o[c][1]!=null&&o[c][1]>n.max||n.max==null)n.max=o[c][1];c>0&&(f=Math.abs(o[c][1]-o[c-1][1]),r.intervals.push(f),r.frequencies.hasOwnProperty(f)?r.frequencies[f]+=1:r.frequencies[f]=1)}i+=f}if(s.renderer.bands){if(s.renderer.bands.hiData.length){var h=s.renderer.bands.hiData;for(var c=0,p=h.length;c<p;c++)if(this.name==="xaxis"||this.name==="x2axis"){h[c][0]=(new e.jsDate(h[c][0])).getTime();if(h[c][0]!=null&&h[c][0]>n.max||n.max==null)n.max=h[c][0]}else{h[c][1]=(new e.jsDate(h[c][1])).getTime();if(h[c][1]!=null&&h[c][1]>n.max||n.max==null)n.max=h[c][1]}}if(s.renderer.bands.lowData.length){var h=s.renderer.bands.lowData;for(var c=0,p=h.length;c<p;c++)if(this.name==="xaxis"||this.name==="x2axis"){h[c][0]=(new e.jsDate(h[c][0])).getTime();if(h[c][0]!=null&&h[c][0]<n.min||n.min==null)n.min=h[c][0]}else{h[c][1]=(new e.jsDate(h[c][1])).getTime();if(h[c][1]!=null&&h[c][1]<n.min||n.min==null)n.min=h[c][1]}}}var d=0,v=0;for(var m in r.frequencies)r.sortedIntervals.push({interval:m,frequency:r.frequencies[m]});r.sortedIntervals.sort(function(e,t){return t.frequency-e.frequency}),r.min=e.jqplot.arrayMin(r.intervals),r.max=e.jqplot.arrayMax(r.intervals),r.mean=i/o.length,this._intervalStats.push(r),r=i=s=o=u=a=null}n=null},e.jqplot.DateAxisRenderer.prototype.reset=function(){this.min=this._options.min,this.max=this._options.max,this.tickInterval=this._options.tickInterval,this.numberTicks=this._options.numberTicks,this._autoFormatString="",this._overrideFormatString&&this.tickOptions&&this.tickOptions.formatString&&(this.tickOptions.formatString=""),this.daTickInterval=this._daTickInterval},e.jqplot.DateAxisRenderer.prototype.createTicks=function(t){var n=this._ticks,r=this.ticks,s=this.name,a=this._dataBounds,f=this._intervalStats,l=this.name.charAt(0)==="x"?this._plotDimensions.width:this._plotDimensions.height,c,p,d,v,m,g,y,b=30,w=1,E=null;if(this.tickInterval!=null)if(Number(this.tickInterval))E=[Number(this.tickInterval),"seconds"];else if(typeof this.tickInterval=="string"){var S=this.tickInterval.split(" ");S.length==1?E=[1,S[0]]:S.length==2&&(E=[S[0],S[1]])}var x=this.tickInterval;p=(new e.jsDate(this.min!=null?this.min:a.min)).getTime(),d=(new e.jsDate(this.max!=null?this.max:a.max)).getTime();var T=t.plugins.cursor;T&&T._zoom&&T._zoom.zooming&&(this.min=null,this.max=null);var N=d-p;if(this.tickOptions==null||!this.tickOptions.formatString)this._overrideFormatString=!0;if(r.length){for(y=0;y<r.length;y++){var C=r[y],k=new this.tickRenderer(this.tickOptions);C.constructor==Array?(k.value=(new e.jsDate(C[0])).getTime(),k.label=C[1],this.showTicks?this.showTickMarks||(k.showMark=!1):(k.showLabel=!1,k.showMark=!1),k.setTick(k.value,this.name),this._ticks.push(k)):(k.value=(new e.jsDate(C)).getTime(),this.showTicks?this.showTickMarks||(k.showMark=!1):(k.showLabel=!1,k.showMark=!1),k.setTick(k.value,this.name),this._ticks.push(k))}this.numberTicks=r.length,this.min=this._ticks[0].value,this.max=this._ticks[this.numberTicks-1].value,this.daTickInterval=[(this.max-this.min)/(this.numberTicks-1)/1e3,"seconds"]}else if(this.min==null&&this.max==null&&a.min==a.max){var L=e.extend(!0,{},this.tickOptions,{name:this.name,value:null}),A=3e5;this.min=a.min-A,this.max=a.max+A,this.numberTicks=3;for(var y=this.min;y<=this.max;y+=A){L.value=y;var k=new this.tickRenderer(L);this._overrideFormatString&&this._autoFormatString!=""&&(k.formatString=this._autoFormatString),k.showLabel=!1,k.showMark=!1,this._ticks.push(k)}this.showTicks&&(this._ticks[1].showLabel=!0),this.showTickMarks&&(this._ticks[1].showTickMarks=!0)}else if(this.min==null&&this.max==null){var O=e.extend(!0,{},this.tickOptions,{name:this.name,value:null}),M,_;if(!this.tickInterval&&!this.numberTicks){var D=Math.max(l,b+1),P=115;this.tickRenderer===e.jqplot.CanvasAxisTickRenderer&&this.tickOptions.angle&&(P=115-40*Math.abs(Math.sin(this.tickOptions.angle/180*Math.PI))),M=Math.ceil((D-b)/P+1),_=(d-p)/(M-1)}else this.tickInterval?_=(new e.jsDate(0)).add(E[0],E[1]).getTime():this.numberTicks&&(M=this.numberTicks,_=(d-p)/(M-1));if(_<=19*i){var H=h(p,d,_),B=H[0];this._autoFormatString=H[1],p=new e.jsDate(p),p=Math.floor((p.getTime()-p.getUtcOffset())/B)*B+p.getUtcOffset(),M=Math.ceil((d-p)/B)+1,this.min=p,this.max=p+(M-1)*B,this.max<d&&(this.max+=B,M+=1),this.tickInterval=B,this.numberTicks=M;for(var y=0;y<M;y++)O.value=this.min+y*B,k=new this.tickRenderer(O),this._overrideFormatString&&this._autoFormatString!=""&&(k.formatString=this._autoFormatString),this.showTicks?this.showTickMarks||(k.showMark=!1):(k.showLabel=!1,k.showMark=!1),this._ticks.push(k);w=this.tickInterval}else if(_<=9*o){this._autoFormatString="%v";var j=Math.round(_/o);j<1?j=1:j>6&&(j=6);var F=(new e.jsDate(p)).setDate(1).setHours(0,0,0,0),I=new e.jsDate(d),q=(new e.jsDate(d)).setDate(1).setHours(0,0,0,0);I.getTime()!==q.getTime()&&(q=q.add(1,"month"));var R=q.diff(F,"month");M=Math.ceil(R/j)+1,this.min=F.getTime(),this.max=F.clone().add((M-1)*j,"month").getTime(),this.numberTicks=M;for(var y=0;y<M;y++)y===0?O.value=F.getTime():O.value=F.add(j,"month").getTime(),k=new this.tickRenderer(O),this._overrideFormatString&&this._autoFormatString!=""&&(k.formatString=this._autoFormatString),this.showTicks?this.showTickMarks||(k.showMark=!1):(k.showLabel=!1,k.showMark=!1),this._ticks.push(k);w=j*o}else{this._autoFormatString="%v";var j=Math.round(_/u);j<1&&(j=1);var F=(new e.jsDate(p)).setMonth(0,1).setHours(0,0,0,0),q=(new e.jsDate(d)).add(1,"year").setMonth(0,1).setHours(0,0,0,0),U=q.diff(F,"year");M=Math.ceil(U/j)+1,this.min=F.getTime(),this.max=F.clone().add((M-1)*j,"year").getTime(),this.numberTicks=M;for(var y=0;y<M;y++)y===0?O.value=F.getTime():O.value=F.add(j,"year").getTime(),k=new this.tickRenderer(O),this._overrideFormatString&&this._autoFormatString!=""&&(k.formatString=this._autoFormatString),this.showTicks?this.showTickMarks||(k.showMark=!1):(k.showLabel=!1,k.showMark=!1),this._ticks.push(k);w=j*u}}else{s=="xaxis"||s=="x2axis"?l=this._plotDimensions.width:l=this._plotDimensions.height,this.min!=null&&this.max!=null&&this.numberTicks!=null&&(this.tickInterval=null),this.tickInterval!=null&&E!=null&&(this.daTickInterval=E);if(p==d){var z=432e5;p-=z,d+=z}N=d-p;var W=2+parseInt(Math.max(0,l-100)/100,10),X,V;X=this.min!=null?(new e.jsDate(this.min)).getTime():p-N/2*(this.padMin-1),V=this.max!=null?(new e.jsDate(this.max)).getTime():d+N/2*(this.padMax-1),this.min=X,this.max=V,N=this.max-this.min;if(this.numberTicks==null)if(this.daTickInterval!=null){var J=(new e.jsDate(this.max)).diff(this.min,this.daTickInterval[1],!0);this.numberTicks=Math.ceil(J/this.daTickInterval[0])+1,this.max=(new e.jsDate(this.min)).add((this.numberTicks-1)*this.daTickInterval[0],this.daTickInterval[1]).getTime()}else l>200?this.numberTicks=parseInt(3+(l-200)/100,10):this.numberTicks=2;w=N/(this.numberTicks-1)/1e3,this.daTickInterval==null&&(this.daTickInterval=[w,"seconds"]);for(var y=0;y<this.numberTicks;y++){var p=new e.jsDate(this.min);g=p.add(y*this.daTickInterval[0],this.daTickInterval[1]).getTime();var k=new this.tickRenderer(this.tickOptions);this.showTicks?this.showTickMarks||(k.showMark=!1):(k.showLabel=!1,k.showMark=!1),k.setTick(g,this.name),this._ticks.push(k)}}this.tickInset&&(this.min=this.min-this.tickInset*w,this.max=this.max+this.tickInset*w),this._daTickInterval==null&&(this._daTickInterval=this.daTickInterval),n=null}})(jQuery);