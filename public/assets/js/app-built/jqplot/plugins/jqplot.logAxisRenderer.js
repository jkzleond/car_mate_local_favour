/**
 * jqPlot
 * Pure JavaScript plotting plugin using jQuery
 *
 * Version: 1.0.8
 * Revision: 1250
 *
 * Copyright (c) 2009-2013 Chris Leonello
 * jqPlot is currently available for use in all personal or commercial projects 
 * under both the MIT (http://www.opensource.org/licenses/mit-license.php) and GPL 
 * version 2.0 (http://www.gnu.org/licenses/gpl-2.0.html) licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly. 
 *
 * Although not required, the author would appreciate an email letting him 
 * know of any substantial use of jqPlot.  You can reach the author at: 
 * chris at jqplot dot com or see http://www.jqplot.com/info.php .
 *
 * If you are feeling kind and generous, consider supporting the project by
 * making a donation at: http://www.jqplot.com/donate.php .
 *
 * sprintf functions contained in jqplot.sprintf.js by Ash Searle:
 *
 *     version 2007.04.27
 *     author Ash Searle
 *     http://hexmen.com/blog/2007/03/printf-sprintf/
 *     http://hexmen.com/js/sprintf.js
 *     The author (Ash Searle) has placed this code in the public domain:
 *     "This code is unrestricted: you are free to use it however you like."
 * 
 */

(function(e){e.jqplot.LogAxisRenderer=function(){e.jqplot.LinearAxisRenderer.call(this),this.axisDefaults={base:10,tickDistribution:"power"}},e.jqplot.LogAxisRenderer.prototype=new e.jqplot.LinearAxisRenderer,e.jqplot.LogAxisRenderer.prototype.constructor=e.jqplot.LogAxisRenderer,e.jqplot.LogAxisRenderer.prototype.init=function(t){this.drawBaseline=!0,this.minorTicks="auto",this._scalefact=1,e.extend(!0,this,t),this._autoFormatString="%d",this._overrideFormatString=!1;for(var n in this.renderer.axisDefaults)this[n]==null&&(this[n]=this.renderer.axisDefaults[n]);this.resetDataBounds()},e.jqplot.LogAxisRenderer.prototype.createTicks=function(t){var n=this._ticks,r=this.ticks,i=this.name,s=this._dataBounds,o=this.name.charAt(0)==="x"?this._plotDimensions.width:this._plotDimensions.height,u,a,f,l,c,h,p,d=30;this._scalefact=(Math.max(o,d+1)-d)/300;if(r.length){for(p=0;p<r.length;p++){var v=r[p],m=new this.tickRenderer(this.tickOptions);v.constructor==Array?(m.value=v[0],m.label=v[1],this.showTicks?this.showTickMarks||(m.showMark=!1):(m.showLabel=!1,m.showMark=!1),m.setTick(v[0],this.name),this._ticks.push(m)):e.isPlainObject(v)?(e.extend(!0,m,v),m.axis=this.name,this._ticks.push(m)):(m.value=v,this.showTicks?this.showTickMarks||(m.showMark=!1):(m.showLabel=!1,m.showMark=!1),m.setTick(v,this.name),this._ticks.push(m))}this.numberTicks=r.length,this.min=this._ticks[0].value,this.max=this._ticks[this.numberTicks-1].value}else if(this.min==null&&this.max==null){a=s.min*(2-this.padMin),f=s.max*this.padMax;if(a==f){var g=.05;a*=1-g,f*=1+g}if(this.min!=null&&this.min<=0)throw new Error("Log axis minimum must be greater than 0");if(this.max!=null&&this.max<=0)throw new Error("Log axis maximum must be greater than 0");function y(e){var t=Math.pow(10,Math.floor(Math.log(e)/Math.LN10));return Math.ceil(e/t)*t}function b(e){var t=Math.pow(10,Math.floor(Math.log(e)/Math.LN10));return Math.floor(e/t)*t}var w,E;w=Math.pow(this.base,Math.floor(Math.log(a)/Math.log(this.base))),E=Math.pow(this.base,Math.ceil(Math.log(f)/Math.log(this.base))),w===0&&(w=1);var S=Math.round(Math.log(w)/Math.LN10);if(this.tickOptions==null||!this.tickOptions.formatString)this._overrideFormatString=!0;this.min=w,this.max=E;var x=this.max-this.min,T=this.minorTicks==="auto"?0:this.minorTicks,N;if(this.numberTicks==null)if(o>140){N=Math.round(Math.log(this.max/this.min)/Math.log(this.base)+1),N<2&&(N=2);if(T===0){var C=o/(N-1);C<100?T=0:C<190?T=1:C<250?T=3:C<600?T=4:T=9}}else N=2,T===0&&(T=1),T=0;else N=this.numberTicks;if(S>=0&&T!==3)this._autoFormatString="%d";else if(S<=0&&T===3){var C=-(S-1);this._autoFormatString="%."+Math.abs(S-1)+"f"}else if(S<0){var C=-S;this._autoFormatString="%."+Math.abs(S)+"f"}else this._autoFormatString="%d";var k,m,L,A,O,u;for(var p=0;p<N;p++){h=Math.pow(this.base,p-N+1)*this.max,m=new this.tickRenderer(this.tickOptions),this._overrideFormatString&&(m.formatString=this._autoFormatString),this.showTicks?this.showTickMarks||(m.showMark=!1):(m.showLabel=!1,m.showMark=!1),m.setTick(h,this.name),this._ticks.push(m);if(T&&p<N-1){A=Math.pow(this.base,p-N+2)*this.max,O=A-h,u=A/(T+1);for(var M=T-1;M>=0;M--)L=A-u*(M+1),m=new this.tickRenderer(this.tickOptions),this._overrideFormatString&&this._autoFormatString!=""&&(m.formatString=this._autoFormatString),this.showTicks?this.showTickMarks||(m.showMark=!1):(m.showLabel=!1,m.showMark=!1),m.setTick(L,this.name),this._ticks.push(m)}}}else if(this.min!=null&&this.max!=null){var _=e.extend(!0,{},this.tickOptions,{name:this.name,value:null}),D,P;if(this.numberTicks==null&&this.tickInterval==null){var H=Math.max(o,d+1),B=Math.ceil((H-d)/35+1),j=e.jqplot.LinearTickGenerator.bestConstrainedInterval(this.min,this.max,B);this._autoFormatString=j[3],D=j[2],P=j[4];for(var p=0;p<D;p++)_.value=this.min+p*P,m=new this.tickRenderer(_),this._overrideFormatString&&this._autoFormatString!=""&&(m.formatString=this._autoFormatString),this.showTicks?this.showTickMarks||(m.showMark=!1):(m.showLabel=!1,m.showMark=!1),this._ticks.push(m)}else if(this.numberTicks!=null&&this.tickInterval!=null){D=this.numberTicks;for(var p=0;p<D;p++)_.value=this.min+p*this.tickInterval,m=new this.tickRenderer(_),this._overrideFormatString&&this._autoFormatString!=""&&(m.formatString=this._autoFormatString),this.showTicks?this.showTickMarks||(m.showMark=!1):(m.showLabel=!1,m.showMark=!1),this._ticks.push(m)}}},e.jqplot.LogAxisRenderer.prototype.pack=function(t,n){var r=parseInt(this.base,10),i=this._ticks,s=function(e){return Math.log(e)/Math.log(r)},o=function(e){return Math.pow(Math.E,Math.log(r)*e)},u=s(this.max),a=s(this.min),f=n.max,l=n.min,c=this._label==null?!1:this._label.show;for(var h in t)this._elem.css(h,t[h]);this._offsets=n;var p=f-l,d=u-a;this.p2u=function(e){return o((e-l)*d/p+a)},this.u2p=function(e){return(s(e)-a)*p/d+l},this.name=="xaxis"||this.name=="x2axis"?(this.series_u2p=function(e){return(s(e)-a)*p/d},this.series_p2u=function(e){return o(e*d/p+a)}):(this.series_u2p=function(e){return(s(e)-u)*p/d},this.series_p2u=function(e){return o(e*d/p+u)});if(this.show)if(this.name=="xaxis"||this.name=="x2axis"){for(var v=0;v<i.length;v++){var m=i[v];if(m.show&&m.showLabel){var g;if(m.constructor==e.jqplot.CanvasAxisTickRenderer&&m.angle)switch(m.labelPosition){case"auto":m.angle<0?g=-m.getWidth()+m._textRenderer.height*Math.sin(-m._textRenderer.angle)/2:g=-m._textRenderer.height*Math.sin(m._textRenderer.angle)/2;break;case"end":g=-m.getWidth()+m._textRenderer.height*Math.sin(-m._textRenderer.angle)/2;break;case"start":g=-m._textRenderer.height*Math.sin(m._textRenderer.angle)/2;break;case"middle":g=-m.getWidth()/2+m._textRenderer.height*Math.sin(-m._textRenderer.angle)/2;break;default:g=-m.getWidth()/2+m._textRenderer.height*Math.sin(-m._textRenderer.angle)/2}else g=-m.getWidth()/2;var y=this.u2p(m.value)+g+"px";m._elem.css("left",y),m.pack()}}if(c){var b=this._label._elem.outerWidth(!0);this._label._elem.css("left",l+p/2-b/2+"px"),this.name=="xaxis"?this._label._elem.css("bottom","0px"):this._label._elem.css("top","0px"),this._label.pack()}}else{for(var v=0;v<i.length;v++){var m=i[v];if(m.show&&m.showLabel){var g;if(m.constructor==e.jqplot.CanvasAxisTickRenderer&&m.angle)switch(m.labelPosition){case"auto":case"end":m.angle<0?g=-m._textRenderer.height*Math.cos(-m._textRenderer.angle)/2:g=-m.getHeight()+m._textRenderer.height*Math.cos(m._textRenderer.angle)/2;break;case"start":m.angle>0?g=-m._textRenderer.height*Math.cos(-m._textRenderer.angle)/2:g=-m.getHeight()+m._textRenderer.height*Math.cos(m._textRenderer.angle)/2;break;case"middle":g=-m.getHeight()/2;break;default:g=-m.getHeight()/2}else g=-m.getHeight()/2;var y=this.u2p(m.value)+g+"px";m._elem.css("top",y),m.pack()}}if(c){var w=this._label._elem.outerHeight(!0);this._label._elem.css("top",f-p/2-w/2+"px"),this.name=="yaxis"?this._label._elem.css("left","0px"):this._label._elem.css("right","0px"),this._label.pack()}}}})(jQuery);