/**
 * jqPlot
 * Pure JavaScript plotting plugin using jQuery
 *
 * Version: 1.0.8
 * Revision: 1250
 *
 * Copyright (c) 2009-2013 Chris Leonello
 * jqPlot is currently available for use in all personal or commercial projects 
 * under both the MIT (http://www.opensource.org/licenses/mit-license.php) and GPL 
 * version 2.0 (http://www.gnu.org/licenses/gpl-2.0.html) licenses. This means that you can 
 * choose the license that best suits your project and use it accordingly. 
 *
 * Although not required, the author would appreciate an email letting him 
 * know of any substantial use of jqPlot.  You can reach the author at: 
 * chris at jqplot dot com or see http://www.jqplot.com/info.php .
 *
 * If you are feeling kind and generous, consider supporting the project by
 * making a donation at: http://www.jqplot.com/donate.php .
 *
 * sprintf functions contained in jqplot.sprintf.js by Ash Searle:
 *
 *     version 2007.04.27
 *     author Ash Searle
 *     http://hexmen.com/blog/2007/03/printf-sprintf/
 *     http://hexmen.com/js/sprintf.js
 *     The author (Ash Searle) has placed this code in the public domain:
 *     "This code is unrestricted: you are free to use it however you like."
 * 
 */

(function(e){e.jqplot.PyramidAxisRenderer=function(){e.jqplot.LinearAxisRenderer.call(this)},e.jqplot.PyramidAxisRenderer.prototype=new e.jqplot.LinearAxisRenderer,e.jqplot.PyramidAxisRenderer.prototype.constructor=e.jqplot.PyramidAxisRenderer,e.jqplot.PyramidAxisRenderer.prototype.init=function(t){this.position=null,this.drawBaseline=!0,this.baselineWidth=null,this.baselineColor=null,this.tickSpacingFactor=25,this._type="pyramid",this._splitAxis=!1,this._splitLength=null,this.category=!1,this._autoFormatString="",this._overrideFormatString=!1,e.extend(!0,this,t),this.renderer.options=t,this.resetDataBounds=this.renderer.resetDataBounds,this.resetDataBounds()},e.jqplot.PyramidAxisRenderer.prototype.resetDataBounds=function(){var e=this._dataBounds;e.min=null,e.max=null;var t;for(var n=0;n<this._series.length;n++){var r=this._series[n],i=r._plotData;for(var s=0,o=i.length;s<o;s++)if(this.name.charAt(0)==="x"){t=i[s][1];if(t!==null&&t<e.min||e.min===null)e.min=t;if(t!==null&&t>e.max||e.max===null)e.max=t}else{t=i[s][0];if(t!==null&&t<e.min||e.min===null)e.min=t;if(t!==null&&t>e.max||e.max===null)e.max=t}}},e.jqplot.PyramidAxisRenderer.prototype.draw=function(t,n){if(this.show){this.renderer.createTicks.call(this,n);var r=0,i;this._elem&&(this._elem.emptyForce(),this._elem=null),this._elem=e(document.createElement("div")),this._elem.addClass("jqplot-axis jqplot-"+this.name),this._elem.css("position","absolute"),this.name=="xaxis"||this.name=="x2axis"?this._elem.width(this._plotDimensions.width):this._elem.height(this._plotDimensions.height),this.labelOptions.axis=this.name,this._label=new this.labelRenderer(this.labelOptions);if(this._label.show){var s=this._label.draw(t,n);s.appendTo(this._elem),s=null}var o=this._ticks,u;for(var a=0;a<o.length;a++)u=o[a],u.show&&u.showLabel&&!u.isMinorTick&&this._elem.append(u.draw(t,n));u=null,o=null}return this._elem};var t=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],n={};for(var r=0,i=t.length;r<i;r++)n[t[r]]=t[r];e.jqplot.PyramidAxisRenderer.prototype.createTicks=function(t){var r=this.ticks,i=this._dataBounds,s,o,u,a,f,l,c,h,p,d,v,m=this.min,g=this.max,y,b,w,E,S,x,T,N,C,k,L=null,A;if(r.length){for(p=0,d=r.length;p<d;p++)y=r[p],b=new this.tickRenderer(this.tickOptions),e.isArray(y)?(b.value=y[0],b.label=y[1],b.setTick(y[0],this.name),this._ticks.push(b)):e.isPlainObject(y)?(e.extend(!0,b,y),b.axis=this.name,this._ticks.push(b)):(typeof y=="string"?k=p+t.defaultAxisStart:k=y,b.value=k,b.label=y,b.axis=this.name,this._ticks.push(b));this.numberTicks=r.length,this.min=this._ticks[0].value,this.max=this._ticks[this.numberTicks-1].value,this.tickInterval=(this.max-this.min)/(this.numberTicks-1);if(this._options.tickInterval){var O=this._options.tickInterval;for(p=0;p<this.numberTicks;p++)p%O!==0&&(this._ticks[p].isMinorTick=!0)}else{s=this.name.charAt(0)==="x"?this._plotDimensions.width:this._plotDimensions.height,C=Math.round(2+s/this.tickSpacingFactor);if(this.numberTicks>C){A=this.numberTicks-1;for(p=2;p<A;p++)if(A%p===0&&A/p<C){L=p-1;break}if(L!==null){var M=1;for(p=1,d=this._ticks.length;p<d;p++)M<=L?(this._ticks[p].show=!1,M+=1):M=1}}}A=[];if(this.category){this._ticks[0].showGridline=!1,this._ticks[0].showMark=!1;for(p=this._ticks.length-1;p>0;p--)b=new this.tickRenderer(this.tickOptions),b.value=this._ticks[p-1].value+this.tickInterval/2,b.label="",b.showLabel=!1,b.axis=this.name,this._ticks[p].showGridline=!1,this._ticks[p].showMark=!1,this._ticks.splice(p,0,b);b=new this.tickRenderer(this.tickOptions),b.value=this._ticks[0].value-this.tickInterval/2,b.label="",b.showLabel=!1,b.axis=this.name,this._ticks.unshift(b),b=new this.tickRenderer(this.tickOptions),b.value=this._ticks[this._ticks.length-1].value+this.tickInterval/2,b.label="",b.showLabel=!1,b.axis=this.name,this._ticks.push(b),this.tickInterval=this.tickInterval/2,this.numberTicks=this._ticks.length,this.min=this._ticks[0].value,this.max=this._ticks[this._ticks.length-1].value}}else{if(this.name.charAt(0)==="x"){s=this._plotDimensions.width;var _=Math.max(i.max,Math.abs(i.min)),D=Math.min(i.min,-_);u=D,a=_,f=a-u;if(this.tickOptions==null||!this.tickOptions.formatString)this._overrideFormatString=!0;w=30,E=Math.max(s,w+1),S=(E-w)/300,x=e.jqplot.LinearTickGenerator(u,a,S),T=u+f*(this.padMin-1),N=a-f*(this.padMax-1);if(u<T||a>N)T=u-f*(this.padMin-1),N=a+f*(this.padMax-1),x=e.jqplot.LinearTickGenerator(T,N,S);this.min=x[0],this.max=x[1],this.numberTicks=x[2],this._autoFormatString=x[3],this.tickInterval=x[4]}else{s=this._plotDimensions.height,u=i.min,a=i.max,v=this._series[0],this._ticks=[],f=a-u,n[f]&&(f+=1,a+=1),this.max=a,this.min=u,C=Math.round(2+s/this.tickSpacingFactor);if(f+1<=C)this.numberTicks=f+1,this.tickInterval=1;else for(var p=C;p>1;p--)if(f/(p-1)===Math.round(f/(p-1))){this.numberTicks=p,this.tickInterval=f/(p-1);break}}this._overrideFormatString&&this._autoFormatString!=""&&(this.tickOptions=this.tickOptions||{},this.tickOptions.formatString=this._autoFormatString);var P;for(p=0;p<this.numberTicks;p++)this.tickOptions.axis=this.name,P=this.min+this.tickInterval*p,this.name.charAt(0)==="x"&&(P=Math.abs(P)),this.tickOptions.value=this.min+this.tickInterval*p,b=new this.tickRenderer(this.tickOptions),b.label=b.prefix+b.formatter(b.formatString,P),this._ticks.push(b),this.name.charAt(0)==="x"&&t.axes.yMidAxis.show&&this.tickOptions.value===0&&(this._splitAxis=!0,this._splitLength=t.axes.yMidAxis.getWidth(),b=new this.tickRenderer(this.tickOptions),this._ticks.push(b),b.value=this.max/2e3);b=null}},e.jqplot.PyramidAxisRenderer.prototype.set=function(){var t=0,n,r=0,s=0,o,u,a,f=this._label==null?!1:this._label.show;if(this.show){u=this._ticks,i=u.length;for(o=0;o<i;o++)a=u[o],!a._breakTick&&a.show&&a.showLabel&&!a.isMinorTick&&(this.name.charAt(0)==="x"?n=a._elem.outerHeight(!0):n=a._elem.outerWidth(!0),n>t&&(t=n));if(this.name==="yMidAxis")for(o=0;o<i;o++)a=u[o],a._elem&&(n=(t-a._elem.outerWidth(!0))/2,a._elem.css("left",n));a=null,u=null,f&&(r=this._label._elem.outerWidth(!0),s=this._label._elem.outerHeight(!0));if(this.name==="xaxis")t+=s,this._elem.css({height:t+"px",left:"0px",bottom:"0px"});else if(this.name==="x2axis")t+=s,this._elem.css({height:t+"px",left:"0px",top:"0px"});else if(this.name==="yaxis")t+=r,this._elem.css({width:t+"px",left:"0px",top:"0px"}),f&&this._label.constructor==e.jqplot.AxisLabelRenderer&&this._label._elem.css("width",r+"px");else if(this.name==="yMidAxis"){var n=t/2-r/2;this._elem.css({width:t+"px",top:"0px"}),f&&this._label.constructor==e.jqplot.AxisLabelRenderer&&this._label._elem.css({width:r,left:n,top:0})}else t+=r,this._elem.css({width:t+"px",right:"0px",top:"0px"}),f&&this._label.constructor==e.jqplot.AxisLabelRenderer&&this._label._elem.css("width",r+"px")}},e.jqplot.PyramidAxisRenderer.prototype.pack=function(t,n){t=t||{},n=n||this._offsets;var r=this._ticks,i=this.max,s=this.min,o=n.max,u=n.min,a=this._label==null?!1:this._label.show;for(var f in t)this._elem.css(f,t[f]);this._offsets=n;var l=o-u,c=i-s,h=this._splitLength;this._splitAxis?(l-=this._splitLength,this.p2u=function(e){return(e-u)*c/l+s},this.u2p=function(e){return e<=0?(e-s)*l/c+u:(e-s)*l/c+u+h},this.series_u2p=function(e){return e<=0?(e-s)*l/c:(e-s)*l/c+h},this.series_p2u=function(e){return e*c/l+s}):(this.p2u=function(e){return(e-u)*c/l+s},this.u2p=function(e){return(e-s)*l/c+u},this.name.charAt(0)==="x"?(this.series_u2p=function(e){return(e-s)*l/c},this.series_p2u=function(e){return e*c/l+s}):(this.series_u2p=function(e){return(e-i)*l/c},this.series_p2u=function(e){return e*c/l+i}));if(this.show)if(this.name.charAt(0)==="x"){for(var p=0;p<r.length;p++){var d=r[p];if(d.show&&d.showLabel){var v;if(d.constructor==e.jqplot.CanvasAxisTickRenderer&&d.angle){var m=this.name=="xaxis"?1:-1;switch(d.labelPosition){case"auto":m*d.angle<0?v=-d.getWidth()+d._textRenderer.height*Math.sin(-d._textRenderer.angle)/2:v=-d._textRenderer.height*Math.sin(d._textRenderer.angle)/2;break;case"end":v=-d.getWidth()+d._textRenderer.height*Math.sin(-d._textRenderer.angle)/2;break;case"start":v=-d._textRenderer.height*Math.sin(d._textRenderer.angle)/2;break;case"middle":v=-d.getWidth()/2+d._textRenderer.height*Math.sin(-d._textRenderer.angle)/2;break;default:v=-d.getWidth()/2+d._textRenderer.height*Math.sin(-d._textRenderer.angle)/2}}else v=-d.getWidth()/2;var g=this.u2p(d.value)+v+"px";d._elem.css("left",g),d.pack()}}if(a){var y=this._label._elem.outerWidth(!0);this._label._elem.css("left",u+l/2-y/2+"px"),this.name=="xaxis"?this._label._elem.css("bottom","0px"):this._label._elem.css("top","0px"),this._label.pack()}}else{for(var p=0;p<r.length;p++){var d=r[p];if(d.show&&d.showLabel&&!d.isMinorTick){var v;if(d.constructor==e.jqplot.CanvasAxisTickRenderer&&d.angle){var m=this.name=="yaxis"?1:-1;switch(d.labelPosition){case"auto":case"end":m*d.angle<0?v=-d._textRenderer.height*Math.cos(-d._textRenderer.angle)/2:v=-d.getHeight()+d._textRenderer.height*Math.cos(d._textRenderer.angle)/2;break;case"start":d.angle>0?v=-d._textRenderer.height*Math.cos(-d._textRenderer.angle)/2:v=-d.getHeight()+d._textRenderer.height*Math.cos(d._textRenderer.angle)/2;break;case"middle":v=-d.getHeight()/2;break;default:v=-d.getHeight()/2}}else v=-d.getHeight()/2;var g=this.u2p(d.value)+v+"px";d._elem.css("top",g),d.pack()}}if(a){var b=this._label._elem.outerHeight(!0);this.name!=="yMidAxis"&&this._label._elem.css("top",o-l/2-b/2+"px"),this.name=="yaxis"?this._label._elem.css("left","0px"):this.name!=="yMidAxis"&&this._label._elem.css("right","0px"),this._label.pack()}}r=null}})(jQuery);